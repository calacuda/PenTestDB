type Command  {
	# id: ID! 
	command: String! @search(by:[fulltext]) 
	local_time: DateTime! 
}

type Port  {
	# id: ID! 
	port: Int! 
	state: String @search(by:[fulltext]) 
	protocol: String @search(by:[fulltext]) 
	service: String @search(by:[fulltext]) 
	version: String @search(by:[fulltext]) 
	machine: Machine! 
	command: Command! 
}

type Machine  {
	# id: ID! 
	ip: String @search(by:[fulltext]) 
	ipv6: String @search(by:[fulltext]) 
	mac_adr: String @search(by:[fulltext]) 
	local_name: String @search(by:[fulltext]) 
	gateway_to: String @search(by:[fulltext]) 
	ports: [Port!] @hasInverse(field:machine) 
	web_dirs: [WebDir!] @hasInverse(field:machine)
  dns_names: [DNSName!] @hasInverse(field:machine)
}

type WebDir  {
	# id: ID!
  dir: String @search(by: [fulltext])
  url: String @search(by: [fulltext])
  base_url: String! @search(by: [fulltext])
  res_code: Int
  protocol: String! @search(by: [fulltext])
  method: String! @search(by: [fulltext])
  num_chars: String! @search(by: [fulltext])
  redirect_adr: String! @search(by: [fulltext])
  command: Command! 
  machine: Machine!
}
type DNSName {
  # id: ID!
  name: String! @search(by: [fulltext])
  is_cname: Boolean!
  points_to: DNSName
  machine: Machine
  command: Command!
}

