function feroxbuster_data {
    echo "    [LOG] feroxbuster dir scan"
    echo "    >> feroxbuster -w $WORDLIST -u http://$TARGET_IP:8888"
    echo -n "    "
    # feroxbuster -w $WORDLIST -u http://$TARGET_IP:8888 2> /dev/null | /etc/ptdb/parsers/feroxbuster.py 1>&2
    feroxbuster -w $WORDLIST -u http://$TARGET_IP:8888 2> /dev/null | target/debug/ptdb parse --exit-status $? --command "feroxbuster -w $WORDLIST -u http://$TARGET_IP:8888"
}

function feroxbuster_test {
    # echo "    [LOG] checking FEROXBUSTER webdirs"
    cmd_uid=$( target/debug/ptdb query -q "SELECT id FROM commands WHERE command = 'feroxbuster -w $WORDLIST -u http://$TARGET_IP:8888';" | head -n 3 | tail -n 1 )
    target/debug/ptdb query -q "SELECT dir, url, base_url, res_code, web_protocol, method, num_chars  FROM web_dirs JOIN commands ON commands.id = web_dirs.command_uid WHERE commands.id = $cmd_uid ORDER BY dir ASC;" > web_dirs-db-query.txt  # ./tests/db-output/feroxbuster-sql.txt  #
    
    if [[ $( diff -adE ./tests/db-output/feroxbuster-sql.txt web_dirs-db-query.txt ) ]]; then
        echo -e '\a' 1>&2
        echo ">> diff -adE ./tests/db-output/feroxbuster-sql.txt web_dirs-db-query.txt" 1>&2
        diff -adE ./tests/db-output/feroxbuster-sql.txt web_dirs-db-query.txt 1>&2
        echo "[LOG] FEROXBUSTER test FAILED"
        exit 1
    else 
        echo "[LOG] FEROXBUSTER test PASSED"
        exit 0
    fi
}