function base_nmap_data {
    echo "    [LOG] nmap scan"
    echo "    >> nmap -n $DB_IP $TARGET_IP"
    echo -n "    "
    nmap -n $DB_IP $TARGET_IP | target/debug/ptdb parse --exit-status $? --command "nmap -n $DB_IP $TARGET_IP"
}

function base_nmap_test {
    cmd_uid=$( target/debug/ptdb query -q "SELECT id FROM commands WHERE command = 'nmap -n $DB_IP $TARGET_IP';" | head -n 3 | tail -n 1 )
    target/debug/ptdb query -q "SELECT port, state, tl_protocol, service, version FROM ports JOIN commands ON commands.id = ports.command_uid WHERE commands.id = $cmd_uid ORDER BY port ASC;" > nmap-db-query.txt  # ./tests/db-output/nmap-sql.txt  # 
    
    if [[ $( diff -adE ./tests/db-output/nmap-sql.txt nmap-db-query.txt ) ]]; then
        echo -e '\a' 1>&2
        echo ">> diff -adE ./tests/db-output/nmap-sql.txt nmap-db-query.txt" 1>&2
        diff -adE ./tests/db-output/nmap-sql.txt nmap-db-query.txt 1>&2
        echo "[LOG] BASE_NMAP test FAILED"
        exit 1
    else
        echo "[LOG] BASE_NMAP test PASSED"
        exit 0
    fi
}