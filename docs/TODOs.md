# TODOs

---
a list of TODOs.

## Current

- [x] replace workspaces with the crate keyword.
- [ ] improve the dig parser.
  - [x] add a config option to not strip ansi escape chars.
  - [x] change understanding of the difference between ipv4 and ipv6 to be based on record type ('A' vs 'AAAA').
  - [x] add 'CNAME' and parsing and other types of record parsing.
    - [x] add a "record_type" column to the dns names table.
    - [x] add a "txt_value" column to the dns names table.
    - [x] add CNAME record parsing to dig.py
    - [x] add MX record parsing to dig.py
    - [ ] update code to handle new "record_type" & "txt_value" columns.
- [ ] stop it from removing data when new but incomplete data is found.
- [ ] add ansi2txt functionality to go buster parser

## Active

- [ ] add interpretation of pipes to command get_cmd() (ie. if something gets piped into a command that can be parsed, parse the output based the program getting piped into.)
- [ ] make the python parsers use objects to output data and make the objects printable via, `__str__(self)`
  - [x] made parser_output.py with a class to make the data easily printable.
  - [x] base_nmap.py integrates with parser_output.py
    - [ ] make it add mac adresses when nessesary.
  - [x] feroxbuster integrates with parser_output.py
  - [x] gobuster integrates with parser_output.py
  - [x] rustscan integrates with parser_output.py
  - [x] fping integrates with parser_output.py
  - [ ] hydra integrates with parser_output.py
  - [x] dig integrates with parser_output.py
  - [ ] john integrates with parser_output.py
  - [ ] john_show integrates with parser_output.py
- [ ] write documentation.
- [ ] add listing of engagements.
- [ ] clear out old TODOS. :P (there are many old TODOs in the [cleared](#cleared) section that date back to the beginning of the project) (they give me motivation but they also clutter this file.)
- [ ] finish designing client and server terminal args.
- [ ] test client server mode.
- [ ] ~~do [this](https://www.codegrepper.com/code-examples/whatever/sed+remove+ansi+color+codes) instead of using the strip_ansi_escape crate.~~ even better, do it per parser in python using regex. (the strip_ansi_escape crate removes tabs inserted by ANSI as well which messes up the dig parser.)
- [ ] write a dog parser. (dog is like dig but simpler, and more elegant imo).
- [ ] move the removal of ANSI control codes to the python parsers bc not all parsers need it and it was interfearing with some parsers. ~~(or maybe add a config option to only strip ansi on certain parsers).~~
  - [ ] find a python module that can strip ANSI control codes (only the color codes).
  - [ ] remove from the rust code.
  - [ ] add to the python parsers where its important.
    - [ ] add to feroxbuster.py
    - [ ] add to rustscan.py
- [ ] bring back sql as an optional feature and allow the user to choose between dgraph and sql.
  - [ ] bring back SQL
  - [ ] fix graphql
- [ ] make ptdb parser output not based on a regex search or signature search of beginning of output.
- [ ] split the `dns_names` table into multiple tables, one for each record type. the cnames table will have multiple columns, that point to the afor mentioned tables.

## On Hold

- [ ] write some code to identify command by command output.
- [ ] add DGraph back end option
  - [x] make the dgraph schema
  - [ ] figure out how to segregate engagements
    - [ ] add an engagement type. that stores a list of each type used in dgraph and search based on that presence in the engagement type with a given name.
  - [x] figure out a clean way to add each entity to the database (and write a GraphQL file to do it
    - [x] figure out how to add the data.
    - [x] change parsers to also output a uid and the things its connected to.
    - [x] add adding of parser data in an idempotent way.
  - [ ] figure out a clean way to modify any entity to the database (and write a GraphQL file to do it)
  - [ ] figure out querying from rust (in either DQL (Dgraph Query Language) or GraphQL)
  - [ ] remove all the SQL specific stuff from the config files
  - [ ] make feroxbuster and gobuster parsers output the a host, which points to the a DNSNames node.

## Maybe Do/Future TODOs

- [ ] add date and time check to client and engagement conf. so it'll not process data before the start date and time. AND alert the user after the engagement is over. set the complete flag to true after the end date and time. (i think this will requires finding a new DateTime library)
- [ ] ~~add optional IP address ranges to engagement conf. that way the program can check to see if the server is in scope. (maybe use nmap IP formatting) then the client can stop you from going out of scope by making a call in `preexec`~~ maybe much later on down the line.
- [ ] ~~make numeric values numerically typed in the sql db~~ (not worth it at the time being)
- [ ] ~~split up local_time column from commands database (on column for year, one for month, day, hour, min, and one fore the time zone offset.)~~ (not worth it at the time being. probably wont be worth it for a while tbh.)

## Cleared

- [x] add an SQL file and a shell script to make the PostgreSQL db.  
- [x] add interaction with SQL
- [x] add password configuration for SQL
- [x] add remote server support (with encryption ofc).
- [x] add a time stamp to the results (added time stamp to command column)
- [x] add hosts and commands to the database first. that way the host & command variables from other tables can contain the id of of the host or command from their respective tables.
- [x] test ssl encryption and remote host connection functionality. ~~(haven't done this yet bc I don't feel like setting up an sql server running elsewhere.)~~ this works! (its a pain in the neck to get configured ssl on postgres but it works.)
- [x] make the program ignore `sudo`, `doas`, `time`, etc, to get the actual command also add interpretation of pipe to get_cmd()
- [x] make host adding edit old host rows if need be
- [x] add dir parameter to output of the parsers for both gobuster and feroxbuster.
- [x] add host row editing. (if at first only the ipv4 adr is known but the dns name is learned later, add the dns name to the same row.)
- [x] same as above but for all tables.
- [x] give the new-engagement subcommand an argument to "activate" the new engagement. (change the engagement line in the config file.)
- [x] and an argument to the engagement subcmd to switch engagements (change the engagement line in the config file.) also add one to check the current engagement.
- [x] implement internal ansi2txt based on [this code](https://github.com/kilobyte/colorized-logs/blob/master/ansi2txt.c) (this was achieved with a module instead.)
- [x] add manual selection of command via command line arg when parsing immediately. (this is done now, but im not pleased that it doesn't know what the command was, only the executable.)
- [x] fixed manual exec setting via cmd line args.
- [x] add terminal based play/pause functionality.
- [x] add a flag to query subcmd to query for then column names of the table.
- [x] add multiple sql server configs
- [x] add subcmd to switch sql server configs (just like `engagement -a`). (achieved with `config -s`)
- [x] split config into global and user configs.
- [x] add `info` subcmd that will print information like: postgres server host, current engagement completeness, and active status (paused vs. actively parsing).
- [x] give the `quiet_log` server config file param functionality.
- [x] fix get_cmd() issue where you can't pass arguments to sudo, time, doas, or proxychains. (this is particularly a problem with proxychains.)
- [x] fix feroxbuster parser crashing when outputing help menu on empty args
- [x] add a way to ignore parsers if the command contains the help args.
- [x] update install instructions
- [x] add an exit status column to the commands table. (this would allow me to only parse certain commands when they exit successfully and not parse commands like ffuf or wfuzz if the user exits the command prematurely bc they're changing parameters and command line arguments.)
- [x] allow each engagement file to declare its own sql-server conf.
- [x] add `SELECT DISTINCT` to the SQL queries generated by command line arguments.
  - [x] add `DISTINCT` to the query generator.
  - [x] ignore `DISTINCT` key word when generating the list of columns selected.
- [x] add `SELECT TOP` to the keyword generator
  - [x] ignore the `TOP` keyword.
  - [x] skip the next token (the number)