#!/usr/bin/python
"""
fping-parser.py

parser for fping commands.


Author: Calacuda | MIT License | Epoch: Oct 6, 2022
"""


from sys import stdin
import re
import sys
folder = "/".join(__file__.split("/")[0:-1])
sys.path.append(folder)
from parser_output import ParserOutput, escape_ansi, make_str


ipv4 = "^([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})?"
nul = chr(0)

output_data = ParserOutput()


def main(full_report):
    hosts = []

    for line in full_report:
        m = re.match(ipv4, line)
        if m:
            hosts.append(m.group())

    [output_data.add_machine({"ip": ip_adr}) for ip_adr in hosts]
    
    print(output_data)
    # return "\n".join([f"ip{nul}'{ip}'" for ip in hosts])

if __name__ == "__main__":
    main(stdin.readlines())