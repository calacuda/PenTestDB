-- tables
CREATE TABLE ports (
  id serial PRIMARY KEY NOT NULL,
  host varchar(255) NOT NULL, -- pointer to id of "hosts" table
  port varchar(255) NOT NULL,
  state varchar(255) NOT NULL,
  protocol varchar(255), -- tcp or udp
  service varchar(255),
  version varchar(255),
  command varchar(255), -- NOT NULL -- pointer to id of "commands" table
  -- CONSTRAINT order_unique UNIQUE (id),
  UNIQUE (port, host, state, service)
  -- dont include version bc of how postgres handles uniqueness and null values
);

CREATE TABLE web_dirs (
  id serial PRIMARY KEY NOT NULL,
  host varchar(255) NOT NULL, -- pointer to id of "hosts" table
  url varchar(255) NOT NULL,
  res_code varchar(255) NOT NULL,
  protocol varchar(255),
  num_chars varchar(255),
  command varchar(255) NOT NULL, -- pointer to id of "commands" table
  UNIQUE (command)
);

CREATE TABLE passwds (
  id serial PRIMARY KEY NOT NULL,
  host varchar(255), -- pointer to id of "hosts" table
  user_name varchar(255),
  pass_wd varchar(255),
  local BOOLEAN,
  ssh BOOLEAN,
  ftp BOOLEAN,
  command varchar(255), -- pointer to id of "commands" table
  -- CONSTRAINT order_unique UNIQUE (id),
  UNIQUE (user_name, pass_wd, host) -- maybe add host?
);

CREATE TABLE hosts (
  id serial PRIMARY KEY NOT NULL,
  ip varchar(255) NOT NULL,
  local_host_name varchar(255), -- if i know the local host name
  dns_name varchar(255),
  gateway_to varchar(255), -- gateway to this box form the outside world
  gateway_from varchar(255), -- gateway from this box to the outside world
  -- CONSTRAINT order_unique UNIQUE (id),
  UNIQUE (ip)
);

CREATE TABLE commands (
  id serial PRIMARY KEY NOT NULL,
  cmd varchar(255) NOT NULL,
  local_time varchar(255) NOT NULL,
  -- output varchar(10240),
  -- CONSTRAINT order_unique UNIQUE (id),
  UNIQUE (cmd, local_time)
)
